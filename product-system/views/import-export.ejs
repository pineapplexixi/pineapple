<%- include('partials/header') %>

<section class="import-export-section">
  <h2>产品数据导入/导出</h2>
  
  <% if (message) { %>
    <div class="alert alert-success">
      <%= message %>
    </div>
  <% } %>
  
  <% if (error) { %>
    <div class="alert alert-error">
      <%= error %>
    </div>
  <% } %>
  
  <div class="import-export-container">
    <div class="import-box">
      <h3>导入Excel数据</h3>
      <p>上传Excel文件导入产品数据。文件必须包含产品ID列。</p>
      
      <form action="/import-export/import" method="POST" enctype="multipart/form-data" class="import-form">
        <div class="form-group">
          <label for="excelFile">选择Excel文件:</label>
          <input type="file" id="excelFile" name="excelFile" accept=".xlsx, .xls" required>
        </div>
        
        <button type="submit" class="btn btn-primary">导入数据</button>
      </form>
      
      <div class="import-notes">
        <h4>导入说明:</h4>
        <ul>
          <li>文件必须包含产品ID列 (标题可以是 "productId", "产品ID" 或 "款号")</li>
          <li>每行数据代表一个产品</li>
          <li>如果产品ID已存在，将更新现有产品</li>
          <li>其他列将作为产品的属性字段</li>
        </ul>
      </div>
    </div>
    
    <div class="export-box">
      <h3>导出产品数据</h3>
      <p>将所有产品数据导出为Excel文件。</p>
      
      <a href="/import-export/export" class="btn btn-primary">导出所有产品</a>
      
      <div class="export-notes">
        <h4>导出说明:</h4>
        <ul>
          <li>导出文件包含所有产品及其所有字段</li>
          <li>导出文件可以修改后重新导入</li>
          <li>如果没有产品，将导出一个带有默认标题的模板</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<%- include('partials/footer') %>